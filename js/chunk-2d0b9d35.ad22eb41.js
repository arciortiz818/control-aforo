(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b9d35"],{3530:function(e,t,s){"use strict";s.r(t);var l=function(){var e=this,t=e._self._c;return t("b-container",[e.isBussy?t("b-icon",{attrs:{icon:"arrow-clockwise",animation:"spin","font-scale":"4"}}):t("b-container",[t("b-row",{staticClass:"mb-3"},[t("b-col",{staticClass:"text-left"},[t("label",[t("b",[e._v("Sede")])]),t("b-form-select",{attrs:{options:e.placesOpt,placeholder:"Seleccione una sede"},on:{change:function(t){return e.changePlace()}},model:{value:e.placeSel,callback:function(t){e.placeSel=t},expression:"placeSel"}})],1)],1),t("b-row",[t("b-col",{staticClass:"text-left"},[t("label",{attrs:{for:"example-datepicker"}},[t("b",[e._v("Fecha")])]),t("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"example-datepicker",placeholder:"Seleccione una fecha"},on:{context:e.onContext}})],1),t("b-col",{staticClass:"text-left"},[t("label",{attrs:{for:"example-datepicker"}},[t("b",[e._v("Horario")])]),t("b-form-select",{attrs:{options:e.schedulesOpt,placeholder:"Seleccione un Horario"},model:{value:e.scheduleSel,callback:function(t){e.scheduleSel=t},expression:"scheduleSel"}})],1)],1),t("b-row",{staticClass:"mt-4"},[t("b-col",[t("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.exportarDatos()}}},[t("b-icon",{attrs:{icon:"file-excel"}}),e._v(" Exportar Datos")],1),t("b-button",{staticClass:"ml-2",attrs:{variant:"outline-primary"},on:{click:function(t){return e.estadisticas()}}},[t("b-icon",{attrs:{icon:"graph-up"}}),e._v(" Estadísticas")],1)],1)],1),t("b-row"),t("b-row",{staticClass:"mt-4"},[t("b-col",[e.isBussy?e._e():t("b-table",{staticStyle:{"font-size":"0.9rem"},attrs:{hover:"",bordered:"",items:e.reservesByDateFiltered,fields:e.fields,"table-variant":"primary","head-variant":"dark",small:"",responsive:"","sort-direction":"asc","sort-by":"idSchedule"},scopedSlots:e._u([{key:"cell(name)",fn:function(s){return[t("p",{staticClass:"text-left"},[e._v(e._s(s.item.name.toUpperCase()))])]}},{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(t.index+1)+" ")]}},{key:"cell(document)",fn:function(s){return[t("p",{staticClass:"text-left"},[e._v(e._s(s.item.document))])]}}],null,!1,2347864909)})],1)],1)],1)],1)},a=[],c=(s("14d9"),s("2f62")),i=s("c1df"),o=s.n(i),r=s("1146"),n=s.n(r),u={data(){return{dateSel:null,scheduleSel:null,schedulesOpt:[],fields:[{key:"index",label:"#"},{key:"idSchedule",thClass:"d-none",tdClass:"d-none",sortable:!0},{key:"schedule",label:"Horario"},{key:"document",label:"Documento"},{key:"name",label:"Nombre"},{key:"phone",label:"Teléfono"},{key:"eps",label:"Eps"},{key:"email",label:"Email"}],isBussy:!1,placesOpt:[],placeSel:null,isBussy:!0,log:{}}},mounted(){localStorage.getItem("emailLogged")||this.$router.replace("/login"),this.setLayout("AdminLayout"),this.getSchedulesByPlace(this.placeSel).then(e=>{this.schedulesOpt.push({value:null,text:"Todos los Horarios"}),this.schedules.forEach(e=>{this.schedulesOpt.push({value:e.schedule,text:e.schedule})})}),this.getPlacesAvailables()},computed:{...Object(c["c"])(["userLogged"]),...Object(c["c"])("schedules",["schedules"]),...Object(c["c"])("reserves",["reservesByDate"]),...Object(c["c"])("places",["places"]),reservesByDateFiltered(){return null==this.scheduleSel?this.reservesByDate.sort((e,t)=>e.document<t.document?-1:e.document>t.document?1:0):this.reservesByDate.filter(e=>e.schedule==this.scheduleSel).sort((e,t)=>e.document<t.document?-1:e.document>t.document?1:0)}},methods:{...Object(c["b"])(["setLayout"]),...Object(c["b"])("reserves",["getReservesByDate","getReservesByDatePrincipal","setPlaceSelected","setIdReserve","deleteReserve"]),...Object(c["b"])("schedules",["getSchedules","getSchedulesByPlace"]),...Object(c["b"])("places",["getPlaces"]),...Object(c["b"])("users",["getLog"]),onContext(e){this.dateSel=null,this.dateSel=e.selectedYMD,this.scheduleSel=null,this.dateSel&&(this.getReserves(),this.getSchedulesOpt())},getReserves(){this.setPlaceSelected({name:this.placeSel,id:this.getIdPlace(this.placeSel)}),this.getReservesByDatePrincipal(this.dateSel)},async getPlacesAvailables(){await this.getPlaces(),this.places.forEach(e=>{this.placesOpt.push({value:e.name,text:e.name+" => "+e.adress})}),this.isBussy=!1},getIdPlace(e){const t=this.places.filter(t=>{if(t.name==e)return t});return t[0].id},async changePlace(){await this.getReserves(),this.getSchedulesOpt()},getSchedulesOpt(){this.getSchedulesByPlace(this.placeSel).then(e=>{this.schedulesOpt=[],this.schedulesOpt.push({value:null,text:"Todos los Horarios"}),this.schedules.forEach(e=>{this.schedulesOpt.push({value:e.schedule,text:e.schedule})})})},exportarDatos(){localStorage.getItem("emailLogged")&&this.$router.push("/admin/export-excel")},estadisticas(){localStorage.getItem("emailLogged")&&this.$router.push("/admin/reports")},async descargarLog(){let e=await this.getLog();this.log=e.filter(e=>"Reserve Created"==e.event).map(e=>({event:e.event,document:e.data.document,date:e.date}));let t=n.a.utils.json_to_sheet(this.log);const s=n.a.utils.book_new(),l="log_"+o()().format("DDMMYYYY");n.a.utils.book_append_sheet(s,t,l),n.a.writeFile(s,l+".xlsx")},async eliminarReserva(e){await this.setIdReserve(e),await this.deleteReserve(),this.changePlace()}}},d=u,h=s("2877"),p=Object(h["a"])(d,l,a,!1,null,"79aa45ea",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d0b9d35.ad22eb41.js.map