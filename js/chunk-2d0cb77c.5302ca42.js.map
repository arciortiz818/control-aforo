{"version":3,"sources":["webpack:///./src/views/ExportExcel.vue","webpack:///src/views/ExportExcel.vue","webpack:///./src/views/ExportExcel.vue?bab3","webpack:///./src/views/ExportExcel.vue?88b5"],"names":["render","_vm","this","_c","_self","isBussy","attrs","_v","staticClass","placesOpt","model","value","placeSel","callback","$$v","expression","dateIniSel","dateEndSel","on","$event","exportar","staticRenderFns","data","dateSel","mounted","localStorage","getItem","$router","replace","setLayout","getPlacesAvailables","computed","mapState","methods","mapActions","getPlaces","push","text","places","forEach","element","name","adress","getIdPlace","namePlace","place","filter","el","id","$toastr","e","getReservesExport","dateIni","dateEnd","then","res","tmpData","map","nombreSede","find","sede","nombre","toUpperCase","fecha","moment","format","xlsx","utils","json_to_sheet","workbook","book_new","filename","book_append_sheet","writeFile","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,cAAc,CAAEF,EAAII,QAASF,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,kBAAkB,UAAY,OAAO,aAAa,OAAOH,EAAG,cAAc,CAACA,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACA,EAAG,KAAK,CAACF,EAAIM,GAAG,uBAAuB,GAAGJ,EAAG,QAAQ,CAACK,YAAY,QAAQ,CAACL,EAAG,QAAQ,CAACK,YAAY,aAAa,CAACL,EAAG,QAAQ,CAACA,EAAG,IAAI,CAACF,EAAIM,GAAG,YAAYJ,EAAG,gBAAgB,CAACG,MAAM,CAAC,QAAUL,EAAIQ,UAAU,YAAc,uBAAuBC,MAAM,CAACC,MAAOV,EAAIW,SAAUC,SAAS,SAAUC,GAAMb,EAAIW,SAASE,GAAKC,WAAW,eAAe,IAAI,GAAGZ,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACK,YAAY,aAAa,CAACL,EAAG,QAAQ,CAACG,MAAM,CAAC,IAAM,6BAA6B,CAACH,EAAG,IAAI,CAACF,EAAIM,GAAG,mBAAmBJ,EAAG,oBAAoB,CAACK,YAAY,OAAOF,MAAM,CAAC,GAAK,2BAA2B,YAAc,wBAAwBI,MAAM,CAACC,MAAOV,EAAIe,WAAYH,SAAS,SAAUC,GAAMb,EAAIe,WAAWF,GAAKC,WAAW,iBAAiB,GAAGZ,EAAG,QAAQ,CAACK,YAAY,aAAa,CAACL,EAAG,QAAQ,CAACG,MAAM,CAAC,IAAM,6BAA6B,CAACH,EAAG,IAAI,CAACF,EAAIM,GAAG,mBAAmBJ,EAAG,oBAAoB,CAACK,YAAY,OAAOF,MAAM,CAAC,GAAK,2BAA2B,YAAc,wBAAwBI,MAAM,CAACC,MAAOV,EAAIgB,WAAYJ,SAAS,SAAUC,GAAMb,EAAIgB,WAAWH,GAAKC,WAAW,iBAAiB,IAAI,GAAGZ,EAAG,QAAQ,CAACK,YAAY,QAAQ,CAACL,EAAG,QAAQ,CAACA,EAAG,WAAW,CAACG,MAAM,CAAC,QAAU,WAAWY,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOlB,EAAImB,cAAc,CAACjB,EAAG,SAAS,CAACG,MAAM,CAAC,KAAO,yBAAyBL,EAAIM,GAAG,wBAAwB,IAAI,IAAI,IAAI,IAAI,IAEz/Cc,EAAkB,G,kECyDP,GACfC,OACA,OACAC,QAAA,KACAlB,SAAA,EACAI,UAAA,GACAG,SAAA,KACAP,SAAA,EACAW,WAAA,KACAC,WAAA,OAGAO,UACAC,aAAAC,QAAA,gBACA,KAAAC,QAAAC,QAAA,UAEA,KAAAC,UAAA,eACA,KAAAC,uBAEAC,SAAA,IACAC,eAAA,mBACAA,eAAA,kCACAA,eAAA,sBAEAC,QAAA,IACAC,eAAA,kBACAA,eAAA,YACA,oBACA,6BACA,mBACA,yBAEAA,eAAA,wBACA,kCACA,KAAAC,YACA,KAAA1B,UAAA2B,KAAA,CACAzB,MAAA,KACA0B,KAAA,UAEA,KAAAC,OAAAC,QAAAC,IACA,KAAA/B,UAAA2B,KAAA,CACAzB,MAAA6B,EAAAC,KACAJ,KAAAG,EAAAC,KAAA,OAAAD,EAAAE,WAGA,KAAArC,SAAA,GAEAsC,WAAAC,GACA,MAAAC,EAAA,KAAAP,OAAAQ,OAAAC,IACA,GAAAA,EAAAN,MAAAG,EACA,OAAAG,IAGA,OAAAF,EAAA,GAAAG,IAEA5B,WACA,KAAAJ,YAAA,KAAAC,WAKA,KAAAD,WAAA,KAAAC,WACA,KAAAgC,QAAAC,EACA,0CACA,kBAIA,KAAAC,kBAAA,CACAC,QAAA,KAAApC,WACAqC,QAAA,KAAApC,WACA4B,MAAA,KAAAjC,SAAA,KAAA+B,WAAA,KAAA/B,UAAA,OACA0C,KAAAC,IACA,IAAAC,EAAAD,EAAAE,IAAAV,IACA,IAAAW,EAAA,KAAApB,OAAAqB,KAAAT,KAAAF,IAAAD,EAAAa,MACA,UACAb,EACAc,OAAAd,EAAAc,OAAAC,cACAC,MAAAC,IAAAjB,EAAAgB,OAAAE,OAAA,cACAL,KAAAF,IAAA,cAGApC,EAAA4C,IAAAC,MAAAC,cAAAZ,GACA,MAAAa,EAAAH,IAAAC,MAAAG,WACAC,EAAA,UAAAP,IAAA,KAAAhD,YAAAiD,OACA,eACAD,IAAA,KAAA/C,YAAAgD,OAAA,cACAC,IAAAC,MAAAK,kBAAAH,EAAA/C,EAAAiD,GACAL,IAAAO,UAAAJ,EAAAE,EAAA,WA/BA,KAAAtB,QAAAC,EAAA,2DCpHqV,I,YCOjVwB,EAAY,eACd,EACA1E,EACAqB,GACA,EACA,KACA,WACA,MAIa,aAAAqD,E","file":"js/chunk-2d0cb77c.5302ca42.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('b-container',[(_vm.isBussy)?_c('b-icon',{attrs:{\"icon\":\"arrow-clockwise\",\"animation\":\"spin\",\"font-scale\":\"4\"}}):_c('b-container',[_c('b-row',[_c('b-col',[_c('h4',[_vm._v(\"Exportar Datos\")])])],1),_c('b-row',{staticClass:\"mb-3\"},[_c('b-col',{staticClass:\"text-left\"},[_c('label',[_c('b',[_vm._v(\"Sede\")])]),_c('b-form-select',{attrs:{\"options\":_vm.placesOpt,\"placeholder\":\"Seleccione una sede\"},model:{value:(_vm.placeSel),callback:function ($$v) {_vm.placeSel=$$v},expression:\"placeSel\"}})],1)],1),_c('b-row',[_c('b-col',{staticClass:\"text-left\"},[_c('label',{attrs:{\"for\":\"example-datepicker-desde\"}},[_c('b',[_vm._v(\"Fecha Desde\")])]),_c('b-form-datepicker',{staticClass:\"mb-2\",attrs:{\"id\":\"example-datepicker-desde\",\"placeholder\":\"Seleccione una fecha\"},model:{value:(_vm.dateIniSel),callback:function ($$v) {_vm.dateIniSel=$$v},expression:\"dateIniSel\"}})],1),_c('b-col',{staticClass:\"text-left\"},[_c('label',{attrs:{\"for\":\"example-datepicker-hasta\"}},[_c('b',[_vm._v(\"Fecha Hasta\")])]),_c('b-form-datepicker',{staticClass:\"mb-2\",attrs:{\"id\":\"example-datepicker-hasta\",\"placeholder\":\"Seleccione una fecha\"},model:{value:(_vm.dateEndSel),callback:function ($$v) {_vm.dateEndSel=$$v},expression:\"dateEndSel\"}})],1)],1),_c('b-row',{staticClass:\"mt-4\"},[_c('b-col',[_c('b-button',{attrs:{\"variant\":\"primary\"},on:{\"click\":function($event){return _vm.exportar()}}},[_c('b-icon',{attrs:{\"icon\":\"cloud-download-fill\"}}),_vm._v(\" Descargar en Excel\")],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <b-container>\r\n    <b-icon\r\n      icon=\"arrow-clockwise\"\r\n      animation=\"spin\"\r\n      font-scale=\"4\"\r\n      v-if=\"isBussy\"\r\n    ></b-icon>\r\n    <b-container v-else>\r\n      <b-row>\r\n        <b-col>\r\n          <h4>Exportar Datos</h4>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row class=\"mb-3\">\r\n        <b-col class=\"text-left\">\r\n          <label><b>Sede</b></label>\r\n          <b-form-select\r\n            v-model=\"placeSel\"\r\n            :options=\"placesOpt\"\r\n            placeholder=\"Seleccione una sede\"\r\n          ></b-form-select>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row>\r\n        <b-col class=\"text-left\">\r\n          <label for=\"example-datepicker-desde\"><b>Fecha Desde</b></label>\r\n          <b-form-datepicker\r\n            id=\"example-datepicker-desde\"\r\n            class=\"mb-2\"\r\n            placeholder=\"Seleccione una fecha\"\r\n            v-model=\"dateIniSel\"\r\n          ></b-form-datepicker>\r\n        </b-col>\r\n        <b-col class=\"text-left\">\r\n          <label for=\"example-datepicker-hasta\"><b>Fecha Hasta</b></label>\r\n          <b-form-datepicker\r\n            id=\"example-datepicker-hasta\"\r\n            class=\"mb-2\"\r\n            placeholder=\"Seleccione una fecha\"\r\n            v-model=\"dateEndSel\"\r\n          ></b-form-datepicker>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row class=\"mt-4\">\r\n        <b-col>\r\n          <b-button variant=\"primary\" @click=\"exportar()\"\r\n            ><b-icon icon=\"cloud-download-fill\"></b-icon> Descargar en\r\n            Excel</b-button\r\n          >\r\n        </b-col>\r\n      </b-row>\r\n    </b-container>\r\n  </b-container>\r\n</template>\r\n<script>\r\nimport { mapActions, mapState } from \"vuex\";\r\nimport moment from \"moment\";\r\nimport xlsx from \"xlsx\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      dateSel: null,\r\n      isBussy: false,\r\n      placesOpt: [],\r\n      placeSel: null,\r\n      isBussy: true,\r\n      dateIniSel: null,\r\n      dateEndSel: null,\r\n    };\r\n  },\r\n  mounted() {\r\n    if (!localStorage.getItem(\"emailLogged\")) {\r\n      this.$router.replace(\"/login\");\r\n    }\r\n    this.setLayout(\"AdminLayout\");\r\n    this.getPlacesAvailables();\r\n  },\r\n  computed: {\r\n    ...mapState([\"userLogged\"]),\r\n    ...mapState(\"reserves\", [\"reservesByDate\"]),\r\n    ...mapState(\"places\", [\"places\"]),\r\n  },\r\n  methods: {\r\n    ...mapActions([\"setLayout\"]),\r\n    ...mapActions(\"reserves\", [\r\n      \"getReservesByDate\",\r\n      \"getReservesByDatePrincipal\",\r\n      \"setPlaceSelected\",\r\n      \"getReservesExport\",\r\n    ]),\r\n    ...mapActions(\"places\", [\"getPlaces\"]),\r\n    async getPlacesAvailables() {\r\n      await this.getPlaces();\r\n      this.placesOpt.push({\r\n        value: null,\r\n        text: \"Todas\",\r\n      });\r\n      this.places.forEach((element) => {\r\n        this.placesOpt.push({\r\n          value: element.name,\r\n          text: element.name + \" => \" + element.adress,\r\n        });\r\n      });\r\n      this.isBussy = false;\r\n    },\r\n    getIdPlace(namePlace) {\r\n      const place = this.places.filter((el) => {\r\n        if (el.name == namePlace) {\r\n          return el;\r\n        }\r\n      });\r\n      return place[0].id;\r\n    },\r\n    exportar() {\r\n      if (!this.dateIniSel || !this.dateEndSel) {\r\n        this.$toastr.e(\"Debe seleccionar un rango de fechas\", \"Exportar excel\");\r\n        return;\r\n      }\r\n\r\n      if (this.dateIniSel > this.dateEndSel) {\r\n        this.$toastr.e(\r\n          \"Las fechas seleccionadas no son vÃ¡lidas\",\r\n          \"Exportar excel\"\r\n        );\r\n        return;\r\n      }\r\n      this.getReservesExport({\r\n        dateIni: this.dateIniSel,\r\n        dateEnd: this.dateEndSel,\r\n        place: this.placeSel ? this.getIdPlace(this.placeSel) : null,\r\n      }).then((res) => {\r\n        let tmpData = res.map((el) => {\r\n          let nombreSede = this.places.find((e) => e.id == el.sede);\r\n          return {\r\n            ...el,\r\n            nombre: el.nombre.toUpperCase(),\r\n            fecha: moment(el.fecha).format(\"DD/MM/YYYY\"),\r\n            sede: nombreSede ? nombreSede[\"name\"] : '',\r\n          };\r\n        });\r\n        let data = xlsx.utils.json_to_sheet(tmpData);\r\n        const workbook = xlsx.utils.book_new();\r\n        const filename = `agenda_${moment(this.dateIniSel).format(\r\n          \"DDMMYYYY\"\r\n        )}_${moment(this.dateEndSel).format(\"DDMMYYYY\")}`;\r\n        xlsx.utils.book_append_sheet(workbook, data, filename);\r\n        xlsx.writeFile(workbook, `${filename}.xlsx`);\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExportExcel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExportExcel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ExportExcel.vue?vue&type=template&id=1bc5d6dd&scoped=true&\"\nimport script from \"./ExportExcel.vue?vue&type=script&lang=js&\"\nexport * from \"./ExportExcel.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1bc5d6dd\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}