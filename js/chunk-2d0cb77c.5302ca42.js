(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cb77c"],{"4a92":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("b-container",[e.isBussy?t("b-icon",{attrs:{icon:"arrow-clockwise",animation:"spin","font-scale":"4"}}):t("b-container",[t("b-row",[t("b-col",[t("h4",[e._v("Exportar Datos")])])],1),t("b-row",{staticClass:"mb-3"},[t("b-col",{staticClass:"text-left"},[t("label",[t("b",[e._v("Sede")])]),t("b-form-select",{attrs:{options:e.placesOpt,placeholder:"Seleccione una sede"},model:{value:e.placeSel,callback:function(t){e.placeSel=t},expression:"placeSel"}})],1)],1),t("b-row",[t("b-col",{staticClass:"text-left"},[t("label",{attrs:{for:"example-datepicker-desde"}},[t("b",[e._v("Fecha Desde")])]),t("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"example-datepicker-desde",placeholder:"Seleccione una fecha"},model:{value:e.dateIniSel,callback:function(t){e.dateIniSel=t},expression:"dateIniSel"}})],1),t("b-col",{staticClass:"text-left"},[t("label",{attrs:{for:"example-datepicker-hasta"}},[t("b",[e._v("Fecha Hasta")])]),t("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"example-datepicker-hasta",placeholder:"Seleccione una fecha"},model:{value:e.dateEndSel,callback:function(t){e.dateEndSel=t},expression:"dateEndSel"}})],1)],1),t("b-row",{staticClass:"mt-4"},[t("b-col",[t("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.exportar()}}},[t("b-icon",{attrs:{icon:"cloud-download-fill"}}),e._v(" Descargar en Excel")],1)],1)],1)],1)],1)},l=[],c=(a("14d9"),a("2f62")),i=a("c1df"),n=a.n(i),o=a("1146"),r=a.n(o),d={data(){return{dateSel:null,isBussy:!1,placesOpt:[],placeSel:null,isBussy:!0,dateIniSel:null,dateEndSel:null}},mounted(){localStorage.getItem("emailLogged")||this.$router.replace("/login"),this.setLayout("AdminLayout"),this.getPlacesAvailables()},computed:{...Object(c["c"])(["userLogged"]),...Object(c["c"])("reserves",["reservesByDate"]),...Object(c["c"])("places",["places"])},methods:{...Object(c["b"])(["setLayout"]),...Object(c["b"])("reserves",["getReservesByDate","getReservesByDatePrincipal","setPlaceSelected","getReservesExport"]),...Object(c["b"])("places",["getPlaces"]),async getPlacesAvailables(){await this.getPlaces(),this.placesOpt.push({value:null,text:"Todas"}),this.places.forEach(e=>{this.placesOpt.push({value:e.name,text:e.name+" => "+e.adress})}),this.isBussy=!1},getIdPlace(e){const t=this.places.filter(t=>{if(t.name==e)return t});return t[0].id},exportar(){this.dateIniSel&&this.dateEndSel?this.dateIniSel>this.dateEndSel?this.$toastr.e("Las fechas seleccionadas no son vÃ¡lidas","Exportar excel"):this.getReservesExport({dateIni:this.dateIniSel,dateEnd:this.dateEndSel,place:this.placeSel?this.getIdPlace(this.placeSel):null}).then(e=>{let t=e.map(e=>{let t=this.places.find(t=>t.id==e.sede);return{...e,nombre:e.nombre.toUpperCase(),fecha:n()(e.fecha).format("DD/MM/YYYY"),sede:t?t["name"]:""}}),a=r.a.utils.json_to_sheet(t);const s=r.a.utils.book_new(),l=`agenda_${n()(this.dateIniSel).format("DDMMYYYY")}_${n()(this.dateEndSel).format("DDMMYYYY")}`;r.a.utils.book_append_sheet(s,a,l),r.a.writeFile(s,l+".xlsx")}):this.$toastr.e("Debe seleccionar un rango de fechas","Exportar excel")}}},p=d,b=a("2877"),u=Object(b["a"])(p,s,l,!1,null,"1bc5d6dd",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0cb77c.5302ca42.js.map